{"ast":null,"code":"/**\r\n * @fileoverview Rule to flag unsafe statements in finally block\r\n * @author Onur Temizkan\r\n */\n\"use strict\"; //------------------------------------------------------------------------------\n// Helpers\n//------------------------------------------------------------------------------\n\nconst SENTINEL_NODE_TYPE_RETURN_THROW = /^(?:Program|(?:Function|Class)(?:Declaration|Expression)|ArrowFunctionExpression)$/u;\nconst SENTINEL_NODE_TYPE_BREAK = /^(?:Program|(?:Function|Class)(?:Declaration|Expression)|ArrowFunctionExpression|DoWhileStatement|WhileStatement|ForOfStatement|ForInStatement|ForStatement|SwitchStatement)$/u;\nconst SENTINEL_NODE_TYPE_CONTINUE = /^(?:Program|(?:Function|Class)(?:Declaration|Expression)|ArrowFunctionExpression|DoWhileStatement|WhileStatement|ForOfStatement|ForInStatement|ForStatement)$/u; //------------------------------------------------------------------------------\n// Rule Definition\n//------------------------------------------------------------------------------\n\n/** @type {import('../shared/types').Rule} */\n\nmodule.exports = {\n  meta: {\n    type: \"problem\",\n    docs: {\n      description: \"disallow control flow statements in `finally` blocks\",\n      recommended: true,\n      url: \"https://eslint.org/docs/rules/no-unsafe-finally\"\n    },\n    schema: [],\n    messages: {\n      unsafeUsage: \"Unsafe usage of {{nodeType}}.\"\n    }\n  },\n\n  create(context) {\n    /**\r\n     * Checks if the node is the finalizer of a TryStatement\r\n     * @param {ASTNode} node node to check.\r\n     * @returns {boolean} - true if the node is the finalizer of a TryStatement\r\n     */\n    function isFinallyBlock(node) {\n      return node.parent.type === \"TryStatement\" && node.parent.finalizer === node;\n    }\n    /**\r\n     * Climbs up the tree if the node is not a sentinel node\r\n     * @param {ASTNode} node node to check.\r\n     * @param {string} label label of the break or continue statement\r\n     * @returns {boolean} - return whether the node is a finally block or a sentinel node\r\n     */\n\n\n    function isInFinallyBlock(node, label) {\n      let labelInside = false;\n      let sentinelNodeType;\n\n      if (node.type === \"BreakStatement\" && !node.label) {\n        sentinelNodeType = SENTINEL_NODE_TYPE_BREAK;\n      } else if (node.type === \"ContinueStatement\") {\n        sentinelNodeType = SENTINEL_NODE_TYPE_CONTINUE;\n      } else {\n        sentinelNodeType = SENTINEL_NODE_TYPE_RETURN_THROW;\n      }\n\n      for (let currentNode = node; currentNode && !sentinelNodeType.test(currentNode.type); currentNode = currentNode.parent) {\n        if (currentNode.parent.label && label && currentNode.parent.label.name === label.name) {\n          labelInside = true;\n        }\n\n        if (isFinallyBlock(currentNode)) {\n          if (label && labelInside) {\n            return false;\n          }\n\n          return true;\n        }\n      }\n\n      return false;\n    }\n    /**\r\n     * Checks whether the possibly-unsafe statement is inside a finally block.\r\n     * @param {ASTNode} node node to check.\r\n     * @returns {void}\r\n     */\n\n\n    function check(node) {\n      if (isInFinallyBlock(node, node.label)) {\n        context.report({\n          messageId: \"unsafeUsage\",\n          data: {\n            nodeType: node.type\n          },\n          node,\n          line: node.loc.line,\n          column: node.loc.column\n        });\n      }\n    }\n\n    return {\n      ReturnStatement: check,\n      ThrowStatement: check,\n      BreakStatement: check,\n      ContinueStatement: check\n    };\n  }\n\n};","map":{"version":3,"sources":["C:/Users/2928/Desktop/zhuawa/notes/project_demo/react_project/node_modules/eslint/lib/rules/no-unsafe-finally.js"],"names":["SENTINEL_NODE_TYPE_RETURN_THROW","SENTINEL_NODE_TYPE_BREAK","SENTINEL_NODE_TYPE_CONTINUE","module","exports","meta","type","docs","description","recommended","url","schema","messages","unsafeUsage","create","context","isFinallyBlock","node","parent","finalizer","isInFinallyBlock","label","labelInside","sentinelNodeType","currentNode","test","name","check","report","messageId","data","nodeType","line","loc","column","ReturnStatement","ThrowStatement","BreakStatement","ContinueStatement"],"mappings":"AAAA;AACA;AACA;AACA;AAEA,a,CAEA;AACA;AACA;;AAEA,MAAMA,+BAA+B,GAAG,qFAAxC;AACA,MAAMC,wBAAwB,GAAG,gLAAjC;AACA,MAAMC,2BAA2B,GAAG,gKAApC,C,CAGA;AACA;AACA;;AAEA;;AACAC,MAAM,CAACC,OAAP,GAAiB;AACbC,EAAAA,IAAI,EAAE;AACFC,IAAAA,IAAI,EAAE,SADJ;AAGFC,IAAAA,IAAI,EAAE;AACFC,MAAAA,WAAW,EAAE,sDADX;AAEFC,MAAAA,WAAW,EAAE,IAFX;AAGFC,MAAAA,GAAG,EAAE;AAHH,KAHJ;AASFC,IAAAA,MAAM,EAAE,EATN;AAWFC,IAAAA,QAAQ,EAAE;AACNC,MAAAA,WAAW,EAAE;AADP;AAXR,GADO;;AAgBbC,EAAAA,MAAM,CAACC,OAAD,EAAU;AAEZ;AACR;AACA;AACA;AACA;AACQ,aAASC,cAAT,CAAwBC,IAAxB,EAA8B;AAC1B,aAAOA,IAAI,CAACC,MAAL,CAAYZ,IAAZ,KAAqB,cAArB,IAAuCW,IAAI,CAACC,MAAL,CAAYC,SAAZ,KAA0BF,IAAxE;AACH;AAED;AACR;AACA;AACA;AACA;AACA;;;AACQ,aAASG,gBAAT,CAA0BH,IAA1B,EAAgCI,KAAhC,EAAuC;AACnC,UAAIC,WAAW,GAAG,KAAlB;AACA,UAAIC,gBAAJ;;AAEA,UAAIN,IAAI,CAACX,IAAL,KAAc,gBAAd,IAAkC,CAACW,IAAI,CAACI,KAA5C,EAAmD;AAC/CE,QAAAA,gBAAgB,GAAGtB,wBAAnB;AACH,OAFD,MAEO,IAAIgB,IAAI,CAACX,IAAL,KAAc,mBAAlB,EAAuC;AAC1CiB,QAAAA,gBAAgB,GAAGrB,2BAAnB;AACH,OAFM,MAEA;AACHqB,QAAAA,gBAAgB,GAAGvB,+BAAnB;AACH;;AAED,WACI,IAAIwB,WAAW,GAAGP,IADtB,EAEIO,WAAW,IAAI,CAACD,gBAAgB,CAACE,IAAjB,CAAsBD,WAAW,CAAClB,IAAlC,CAFpB,EAGIkB,WAAW,GAAGA,WAAW,CAACN,MAH9B,EAIE;AACE,YAAIM,WAAW,CAACN,MAAZ,CAAmBG,KAAnB,IAA4BA,KAA5B,IAAsCG,WAAW,CAACN,MAAZ,CAAmBG,KAAnB,CAAyBK,IAAzB,KAAkCL,KAAK,CAACK,IAAlF,EAAyF;AACrFJ,UAAAA,WAAW,GAAG,IAAd;AACH;;AACD,YAAIN,cAAc,CAACQ,WAAD,CAAlB,EAAiC;AAC7B,cAAIH,KAAK,IAAIC,WAAb,EAA0B;AACtB,mBAAO,KAAP;AACH;;AACD,iBAAO,IAAP;AACH;AACJ;;AACD,aAAO,KAAP;AACH;AAED;AACR;AACA;AACA;AACA;;;AACQ,aAASK,KAAT,CAAeV,IAAf,EAAqB;AACjB,UAAIG,gBAAgB,CAACH,IAAD,EAAOA,IAAI,CAACI,KAAZ,CAApB,EAAwC;AACpCN,QAAAA,OAAO,CAACa,MAAR,CAAe;AACXC,UAAAA,SAAS,EAAE,aADA;AAEXC,UAAAA,IAAI,EAAE;AACFC,YAAAA,QAAQ,EAAEd,IAAI,CAACX;AADb,WAFK;AAKXW,UAAAA,IALW;AAMXe,UAAAA,IAAI,EAAEf,IAAI,CAACgB,GAAL,CAASD,IANJ;AAOXE,UAAAA,MAAM,EAAEjB,IAAI,CAACgB,GAAL,CAASC;AAPN,SAAf;AASH;AACJ;;AAED,WAAO;AACHC,MAAAA,eAAe,EAAER,KADd;AAEHS,MAAAA,cAAc,EAAET,KAFb;AAGHU,MAAAA,cAAc,EAAEV,KAHb;AAIHW,MAAAA,iBAAiB,EAAEX;AAJhB,KAAP;AAMH;;AAxFY,CAAjB","sourcesContent":["/**\r\n * @fileoverview Rule to flag unsafe statements in finally block\r\n * @author Onur Temizkan\r\n */\r\n\r\n\"use strict\";\r\n\r\n//------------------------------------------------------------------------------\r\n// Helpers\r\n//------------------------------------------------------------------------------\r\n\r\nconst SENTINEL_NODE_TYPE_RETURN_THROW = /^(?:Program|(?:Function|Class)(?:Declaration|Expression)|ArrowFunctionExpression)$/u;\r\nconst SENTINEL_NODE_TYPE_BREAK = /^(?:Program|(?:Function|Class)(?:Declaration|Expression)|ArrowFunctionExpression|DoWhileStatement|WhileStatement|ForOfStatement|ForInStatement|ForStatement|SwitchStatement)$/u;\r\nconst SENTINEL_NODE_TYPE_CONTINUE = /^(?:Program|(?:Function|Class)(?:Declaration|Expression)|ArrowFunctionExpression|DoWhileStatement|WhileStatement|ForOfStatement|ForInStatement|ForStatement)$/u;\r\n\r\n\r\n//------------------------------------------------------------------------------\r\n// Rule Definition\r\n//------------------------------------------------------------------------------\r\n\r\n/** @type {import('../shared/types').Rule} */\r\nmodule.exports = {\r\n    meta: {\r\n        type: \"problem\",\r\n\r\n        docs: {\r\n            description: \"disallow control flow statements in `finally` blocks\",\r\n            recommended: true,\r\n            url: \"https://eslint.org/docs/rules/no-unsafe-finally\"\r\n        },\r\n\r\n        schema: [],\r\n\r\n        messages: {\r\n            unsafeUsage: \"Unsafe usage of {{nodeType}}.\"\r\n        }\r\n    },\r\n    create(context) {\r\n\r\n        /**\r\n         * Checks if the node is the finalizer of a TryStatement\r\n         * @param {ASTNode} node node to check.\r\n         * @returns {boolean} - true if the node is the finalizer of a TryStatement\r\n         */\r\n        function isFinallyBlock(node) {\r\n            return node.parent.type === \"TryStatement\" && node.parent.finalizer === node;\r\n        }\r\n\r\n        /**\r\n         * Climbs up the tree if the node is not a sentinel node\r\n         * @param {ASTNode} node node to check.\r\n         * @param {string} label label of the break or continue statement\r\n         * @returns {boolean} - return whether the node is a finally block or a sentinel node\r\n         */\r\n        function isInFinallyBlock(node, label) {\r\n            let labelInside = false;\r\n            let sentinelNodeType;\r\n\r\n            if (node.type === \"BreakStatement\" && !node.label) {\r\n                sentinelNodeType = SENTINEL_NODE_TYPE_BREAK;\r\n            } else if (node.type === \"ContinueStatement\") {\r\n                sentinelNodeType = SENTINEL_NODE_TYPE_CONTINUE;\r\n            } else {\r\n                sentinelNodeType = SENTINEL_NODE_TYPE_RETURN_THROW;\r\n            }\r\n\r\n            for (\r\n                let currentNode = node;\r\n                currentNode && !sentinelNodeType.test(currentNode.type);\r\n                currentNode = currentNode.parent\r\n            ) {\r\n                if (currentNode.parent.label && label && (currentNode.parent.label.name === label.name)) {\r\n                    labelInside = true;\r\n                }\r\n                if (isFinallyBlock(currentNode)) {\r\n                    if (label && labelInside) {\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        /**\r\n         * Checks whether the possibly-unsafe statement is inside a finally block.\r\n         * @param {ASTNode} node node to check.\r\n         * @returns {void}\r\n         */\r\n        function check(node) {\r\n            if (isInFinallyBlock(node, node.label)) {\r\n                context.report({\r\n                    messageId: \"unsafeUsage\",\r\n                    data: {\r\n                        nodeType: node.type\r\n                    },\r\n                    node,\r\n                    line: node.loc.line,\r\n                    column: node.loc.column\r\n                });\r\n            }\r\n        }\r\n\r\n        return {\r\n            ReturnStatement: check,\r\n            ThrowStatement: check,\r\n            BreakStatement: check,\r\n            ContinueStatement: check\r\n        };\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"script"}